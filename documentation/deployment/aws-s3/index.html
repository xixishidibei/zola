<!DOCTYPE html>
<html lang="en-gb">
    <head>
        <meta charset="UTF-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Everything you need to make a static site engine in one binary.">
        <meta name="author" content="Vincent Prouillet">
        <title>AWS S3 Bucket | Zola </title>
        <link rel="stylesheet" href="https://www.getzola.org/site.css">
        <link rel="icon" href="https://www.getzola.org/favicon.ico">
    </head>
    <body>

        <header>
            <a class="header__logo white" href="https:&#x2F;&#x2F;www.getzola.org&#x2F;">Zola</a>
            <nav>
                <ul>
                    <li><a class="white" href="https://www.getzola.org/documentation/" class="nav-link">Docs</a></li>
                    <li><a class="white" href="https://www.getzola.org/themes/" class="nav-link">Themes</a></li>
                    <li><a class="white" href="https://zola.discourse.group/" class="nav-link">Forum</a></li>
                    <li><a class="white" href="https://github.com/getzola/zola" class="nav-link">GitHub</a></li>
                </ul>
                <div class="search-container">
                    <input id="search" type="search" placeholder="ðŸ”Ž Search the docs">

                    <div class="search-results">
                        <div class="search-results__items"></div>
                    </div>
                </div>
            </nav>
        </header>

        <div class="content content--reversed">
            

<div class="documentation">
    <aside class="documentation__sidebar">
        <ul>
        
            
            <li>
                <span class="documentation__sidebar__title">Getting Started</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;getting-started&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;getting-started&#x2F;installation&#x2F;">Installation</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;getting-started&#x2F;cli-usage&#x2F;">CLI usage</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;getting-started&#x2F;directory-structure&#x2F;">Directory structure</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;getting-started&#x2F;configuration&#x2F;">Configuration</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Content</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;section&#x2F;">Section</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;page&#x2F;">Page</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;shortcodes&#x2F;">Shortcodes</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;linking&#x2F;">Internal links &amp; deep linking</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;table-of-contents&#x2F;">Table of Contents</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;syntax-highlighting&#x2F;">Syntax Highlighting</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;taxonomies&#x2F;">Taxonomies</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;search&#x2F;">Search</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;sass&#x2F;">Sass</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;image-processing&#x2F;">Image processing</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;content&#x2F;multilingual&#x2F;">Multilingual sites</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Templates</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;pages-sections&#x2F;">Sections and Pages</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;pagination&#x2F;">Pagination</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;taxonomies&#x2F;">Taxonomies</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;feeds&#x2F;">Feeds</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;sitemap&#x2F;">Sitemap</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;robots&#x2F;">Robots.txt</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;404&#x2F;">404 error page</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;templates&#x2F;archive&#x2F;">Archive</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Themes</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;themes&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;themes&#x2F;installing-and-using-themes&#x2F;">Installing &amp; using themes</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;themes&#x2F;creating-a-theme&#x2F;">Creating a theme</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;themes&#x2F;extending-a-theme&#x2F;">Customizing a theme</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Deployment</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;sourcehut&#x2F;">Sourcehut Pages</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;netlify&#x2F;">Netlify</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;github-pages&#x2F;">GitHub Pages</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;gitlab-pages&#x2F;">GitLab Pages</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;codeberg-pages&#x2F;">Codeberg Pages</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;edgio&#x2F;">Edgio</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;vercel&#x2F;">Vercel</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;zeabur&#x2F;">Zeabur</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;cloudflare-pages&#x2F;">Cloudflare Pages</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;flyio&#x2F;">Fly.io</a>
                        </li>
                    
                        <li class="active">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;aws-s3&#x2F;">AWS S3 Bucket</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;www.getzola.org&#x2F;documentation&#x2F;deployment&#x2F;docker-image&#x2F;">Docker image</a>
                        </li>
                    
                </ul>
            </li>
        
        </ul>
    </aside>
    <div class="documentation__content">
        
    <h1>AWS S3 Bucket</h1>
    <p>Amazon Simple Storage Service (Amazon S3) is an object storage service offering static website hosting. We're going to look at the setup required to build and deploy your Zola website to S3 via GitHub Actions.</p>
<h2 id="aws-setup"><a class="zola-anchor" href="#aws-setup" aria-label="Anchor link for: aws-setup">ðŸ”—</a>AWS Setup</h2>
<p><a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/getting-started-cloudfront-overview.html">The official AWS developer</a> guide has detailed instruction on how to create your bucket and set it up correctly for static website hosting. In AWS you can not only host the website files, but also buy a domain name and speed up your website via their global CDN (CloudFront).</p>
<p>For GitHub Actions to modify the files in your bucket, you need to create an IAM user in your AWS account that has just enough permissions to perform what we need and no more.</p>
<p>First we need to create a new policy by logging on to AWS Console and going to <strong>IAM</strong> &gt; <strong>Policies</strong> &gt; <strong>Create policy</strong>. Switch from the visual editor to <strong>JSON</strong> and paste the following snippet. Remember to update your bucket name:</p>
<pre data-lang="json" style="background-color:#383838;color:#e6e1dc;" class="language-json "><code class="language-json" data-lang="json"><span>{
</span><span>  </span><span style="color:#c1be91;">&quot;Version&quot;</span><span>: </span><span style="color:#c1be91;">&quot;2012-10-17&quot;</span><span>,
</span><span>  </span><span style="color:#c1be91;">&quot;Statement&quot;</span><span>: [
</span><span>    {
</span><span>      </span><span style="color:#c1be91;">&quot;Sid&quot;</span><span>: </span><span style="color:#c1be91;">&quot;AccessToWebsiteBuckets&quot;</span><span>,
</span><span>      </span><span style="color:#c1be91;">&quot;Effect&quot;</span><span>: </span><span style="color:#c1be91;">&quot;Allow&quot;</span><span>,
</span><span>      </span><span style="color:#c1be91;">&quot;Action&quot;</span><span>: [
</span><span>        </span><span style="color:#c1be91;">&quot;s3:PutBucketWebsite&quot;</span><span>,
</span><span>        </span><span style="color:#c1be91;">&quot;s3:PutObject&quot;</span><span>,
</span><span>        </span><span style="color:#c1be91;">&quot;s3:PutObjectAcl&quot;</span><span>,
</span><span>        </span><span style="color:#c1be91;">&quot;s3:GetObject&quot;</span><span>,
</span><span>        </span><span style="color:#c1be91;">&quot;s3:ListBucket&quot;</span><span>,
</span><span>        </span><span style="color:#c1be91;">&quot;s3:DeleteObject&quot;
</span><span>      ],
</span><span>      </span><span style="color:#c1be91;">&quot;Resource&quot;</span><span>: [
</span><span>        </span><span style="color:#c1be91;">&quot;arn:aws:s3:::Bucket-Name&quot;
</span><span>        </span><span style="color:#c1be91;">&quot;arn:aws:s3:::Bucket-Name/*&quot;
</span><span>      ]
</span><span>    },
</span><span>    {
</span><span>      </span><span style="color:#c1be91;">&quot;Sid&quot;</span><span>: </span><span style="color:#c1be91;">&quot;AccessToCloudfront&quot;</span><span>,
</span><span>      </span><span style="color:#c1be91;">&quot;Effect&quot;</span><span>: </span><span style="color:#c1be91;">&quot;Allow&quot;</span><span>,
</span><span>      </span><span style="color:#c1be91;">&quot;Action&quot;</span><span>: [</span><span style="color:#c1be91;">&quot;cloudfront:GetInvalidation&quot;</span><span>, </span><span style="color:#c1be91;">&quot;cloudfront:CreateInvalidation&quot;</span><span>],
</span><span>      </span><span style="color:#c1be91;">&quot;Resource&quot;</span><span>: </span><span style="color:#c1be91;">&quot;*&quot;
</span><span>    }
</span><span>  ]
</span><span>}
</span></code></pre>
<p>The <code>AccessToCloudfront</code> portion is not required if you're not going to speed up your website with CloudFront.</p>
<p>Once the policy is created you need to create a new user under <strong>IAM</strong> &gt; <strong>Users</strong>. Give it a name such as <code>github-actions-user</code>. On the <strong>Set permissions</strong> step select <strong>Attach policies directly</strong> and find the policy we created in the last step. </p>
<p>From the list of users click on your newly created account and then open the <strong>Security Credentials</strong> tab. Under <strong>Access keys</strong> select &gt; <strong>Create access key</strong> and choose <strong>Command Line Interface (CLI)</strong>. Click &quot;I understand the above recommendation&quot; and then <strong>Create access key</strong>. Note the <strong>Access key ID</strong> and <strong>Secret access key</strong>.</p>
<h2 id="setup-secrets-in-github"><a class="zola-anchor" href="#setup-secrets-in-github" aria-label="Anchor link for: setup-secrets-in-github">ðŸ”—</a>Setup Secrets in GitHub</h2>
<p>The access keys we just created need to be configured as secrets in your GitHub repo. To do so, navigate to <strong>Setting</strong> &gt; expand <strong>Secrets and variables</strong> &gt; click on <strong>Actions</strong>.</p>
<p>Under <strong>Repository secrets</strong> click <strong>Add repository secret</strong>. In the <em>Name</em> field enter <code>AWS_ACCESS_KEY_ID</code> and in the  <em>Secret</em> field enter the value from the previous step. Do the same for the secret access key, naming it <code>AWS_SECRET_ACCESS_KEY</code>. Finally create one secret for your bucket name <code>S3_BUCKET</code> and one <code>CLOUDFRONT_DISTRIBUTION_ID</code> if you have created a distribution for your website.</p>
<h2 id="github-actions"><a class="zola-anchor" href="#github-actions" aria-label="Anchor link for: github-actions">ðŸ”—</a>GitHub Actions</h2>
<p>Next we need to create the <em>Github Action</em> to build and deploy our files to S3. We need to create a workflow file in <code>.github/workflows</code> directory of our repository. This can be done by navigating to the <em>Actions</em> tab in GitHub or by commiting the file from your machine.</p>
<p><code>.github/workflows/publish.yml</code>:</p>
<pre data-lang="yaml" style="background-color:#383838;color:#e6e1dc;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#e8bf6a;">name</span><span>: </span><span style="color:#a5c261;">Build and Publish to AWS
</span><span style="color:#6e9cbe;">on</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">push</span><span>:
</span><span>    </span><span style="color:#e8bf6a;">branches</span><span>:
</span><span>      - </span><span style="color:#a5c261;">main
</span><span style="color:#e8bf6a;">jobs</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">run</span><span>:
</span><span>    </span><span style="color:#e8bf6a;">runs-on</span><span>: </span><span style="color:#a5c261;">ubuntu-latest
</span><span>    </span><span style="color:#e8bf6a;">timeout-minutes</span><span>: </span><span style="color:#a5c261;">10
</span><span>    </span><span style="color:#e8bf6a;">steps</span><span>:
</span><span>      - </span><span style="color:#e8bf6a;">uses</span><span>: </span><span style="color:#a5c261;">actions/checkout@v3
</span><span>      - </span><span style="color:#e8bf6a;">uses</span><span>: </span><span style="color:#a5c261;">taiki-e/install-action@v2
</span><span>        </span><span style="color:#e8bf6a;">with</span><span>:
</span><span>          </span><span style="color:#e8bf6a;">tool</span><span>: </span><span style="color:#a5c261;">zola@0.17.2
</span><span>      - </span><span style="color:#e8bf6a;">name</span><span>: </span><span style="color:#a5c261;">Build
</span><span>        </span><span style="color:#e8bf6a;">run</span><span>: </span><span style="color:#a5c261;">zola build
</span><span>      - </span><span style="color:#e8bf6a;">uses</span><span>: </span><span style="color:#a5c261;">reggionick/s3-deploy@v4
</span><span>        </span><span style="color:#e8bf6a;">env</span><span>:
</span><span>          </span><span style="color:#e8bf6a;">AWS_ACCESS_KEY_ID</span><span>: </span><span style="color:#a5c261;">${{ secrets.AWS_ACCESS_KEY_ID }}
</span><span>          </span><span style="color:#e8bf6a;">AWS_SECRET_ACCESS_KEY</span><span>: </span><span style="color:#a5c261;">${{ secrets.AWS_SECRET_ACCESS_KEY }}
</span><span>        </span><span style="color:#e8bf6a;">with</span><span>:
</span><span>          </span><span style="color:#e8bf6a;">folder</span><span>: </span><span style="color:#a5c261;">public
</span><span>          </span><span style="color:#e8bf6a;">bucket</span><span>: </span><span style="color:#a5c261;">${{ secrets.S3_BUCKET }}
</span><span>          </span><span style="color:#e8bf6a;">private</span><span>: </span><span style="color:#6e9cbe;">true
</span><span>          </span><span style="color:#e8bf6a;">bucket-region</span><span>: </span><span style="color:#a5c261;">us-east-1
</span><span>          </span><span style="color:#95815e;"># Use the next two only if you have created a CloudFront distribution
</span><span>          </span><span style="color:#e8bf6a;">dist-id</span><span>: </span><span style="color:#a5c261;">${{ secrets.CLOUDFRONT_DISTRIBUTION_ID }}
</span><span>          </span><span style="color:#e8bf6a;">invalidation</span><span>: </span><span style="color:#a5c261;">/*
</span></code></pre>
<p>Note, that you may need to change the branch name in the above snippet if you desire a different behavior.</p>


    </div>
</div>

        </div>
        <footer>
            Â©2017-2024 â€” <a class="white" href="https://www.vincentprouillet.com">Vincent Prouillet</a> and <a class="white" href="https://github.com/getzola/zola/graphs/contributors">contributors</a>
        </footer>

        <script type="text/javascript" src="https://www.getzola.org/elasticlunr.min.js"></script>
        <script type="text/javascript" src="https://www.getzola.org/search.js"></script>
    </body>
</html>
